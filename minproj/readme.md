# ЕИС "Комплексная реабилитация инвалидов"
<!-- ![git-logo](https://git-scm.com/images/logos/downloads/Git-Logo-2Color.png)  -->

---

## Архитектура и структура базы данных:
- Реализация с использованием СУБД PostgreSQL 15

![DB](DB.jpg)

### Пользователи и роли:


**1. Администратор**
- Создание Ведомств, выдача доступа регистрации Координаторам и Операторам (либо самостоятельное добавление пользователей)
- Валидация Координаторов и Операторов
- Оповещения о регистрации Координаторов и Операторов через эл.почту
- Управление через админку, полный доступ (микросервис Minapp)

**2. Оператор**
- Создание Учреждений и Событий для Получателей
- Контроль выполнения Событий Получателями
- Оповещения о валидности регистрации Получателей через эл.почту
- Управление через личный кабинет (микросервис Operators)

**3. Координатор**
- Выдача доступа регистрации Получателям (либо самостоятельное добавление пользователей)
- Валидация Получателей
- Оповещения о создании Оператором Событий для Получателей через эл.почту
- Валидация Событий
- Оповещения о регистрации Получателей через эл.почту
- Валидация Получателей
- Управление через личный кабинет (микросервис Coordinators)

**4. Получатель**
- Просмотр информации об Учреждениях
- Просмотр маршрута реабилитации (событий)
- Управление через личный кабинет (микросервис Recepients)

---
## Архитектура и бизнес-логика

### Реализация проекта на фреймворке Django, интерпретатор python 3.11, микросервисная архитектура:
- minproj - конфигурационный модуль, объединяющий микросервисы
- Minapp - админка, ORM, аутентификация пользователей, Ведомства
  - \login - единая точка входа, редирект в зависимости от роли Пользователя 
  - Ведомство Оператора выделяется
- Coordinators - ЛК Координатора - регистрация/редактирование/удаление(is_active=False) Координатора, список Координаторов, сигналы Администратору
- Operators - ЛК Оператора - регистрация/редактирование/удаление(is_active=False) Оператора, список Операторов, сигналы Администратору
  - Оператор прикреплен к Ведомству (1 или несколько)
- Recipients - ЛК Получателя - регистрация/редактирование/удаление(is_active=False) Получателя, список Получателей, сигналы Координаторам и Операторам, Маршрут Получателя
  - Получатель может просматривать только собственный маршрут, доступ только к GET-запросам 
- Locations - создание/просмотр/редактирование/удаление(is_active=False) Учреждений
  - Учреждения могут создавать только Операторы и только связанные с соответствущими Ведомствами 
- Events - создание/просмотр/редактирование/удаление событий
  - К созданным событиям автоматически подвязывается ведомство Оператора
  - События можно создавать только для активных и подтвержденных Получателей
  - Оповещения Координаторов о создании Событий для подтверждения по эл.почте
  - Оповещения Получателей о новых Событиях
  - Статус "Выполнено" у События Оператор может поставить только, если Событие согласовано
  - Оператор может редактировать События, только которые относятся к Учреждениям его Ведомства
  
---
## Маршруты и права доступа
/login *- Вход в систему (все пользователи)* 

/logout *- Выход (все пользователи)*

---

/admin *- Админка (Администратор)*

---

/departments *- Все ведомства (Координаторы, Операторы, Получатели)*

/departments/id/locations *- Учреждения Ведомства (Координаторы, Операторы, Получатели)*

---

/coordinators *- Все активные Координаторы (Координаторы, Операторы, Получатели)*

/coordinators/signup *- Регистрация Координатора (Все)*

/coordinators/wait *- Страница-заглушка ожидания подтверждения валидности от Администратора (Все)*

/coordinators/id *- Профиль Координатора (Координаторы, Операторы, Получатели)*

/coordinators/id/update *- Редактирование профиля (Координатор!)*

/coordinators/id/delete *- Удаление профиля (is_active=False) (Координатор!)*

---

/operators *- Все активные Операторы (Координаторы, Операторы)*

/operators/signup *- Регистрация Оператора (Все)*

/operators/wait *- Страница-заглушка ожидания подтверждения валидности от Администратора (Все)*

/operators/id *- Профиль Оператора (Координаторы, Операторы)*

/operators/id/update *- Редактирование профиля (Оператор!)*

/operators/id/delete *- Удаление профиля (is_active=False) (Оператор!)*

---

/recipients *- Все Получатели (для Операторов только активные) (Координаторы, Операторы)*

/recipients/signup *- Регистрация Оператора (Все)*

/recipients/wait *- Страница-заглушка ожидания подтверждения валидности от Координатора (Все)*

/recipients/id *- Профиль Получателя (Координаторы, Операторы, Получатель!)*

/recipients/id/update *- Редактирование информации профиля (Получатель!)*

/recipients/id/edit *- Редактирование статуса Получателя is_active, is_check (Координаторы)*

/recipients/id/delete *- Удаление профиля (is_active=False) (Получатель!)*

/recipients/id/events *- Маршрут Получателя (Координаторы, Операторы, Получатель!)*

---

/locations *- Все Учреждения (для Координаторов и Получателей только активные, для Операторов показываются также неактивные Учреждения своего Ведомства) (Координаторы, Операторы, Получатели)*

/locations/create *- Создание Учреждения (Операторы)*

/locations/id *- Данные Учреждения (Координаторы, Операторы, Получатели)*

/locations/id/update *- Редактирование Учреждения (Операторы того же Ведомства, что и Учреждение)*

/locations/id/delete *- Удаление Учреждения (is_active=False) (Операторы того же Ведомства, что и Учреждение)*

---

/events *- Все События (в т.ч. несогласованные и незавершенные) (Координаторы, Операторы)*

/events/create *- Создание События (Операторы)*

/events/id *- Данные События (Координаторы, Операторы, Получатель!)*

/events/id/update *- Редактирование информации События (is_finished доступно только если is_check) (Операторы того же Ведомства, что и Учреждение События)*

/events/id/edit *- Редактирование статуса События is_check (Координаторы)*

/events/id/delete *- Удаление События (Операторы того же Ведомства, что и Учреждение События)*

